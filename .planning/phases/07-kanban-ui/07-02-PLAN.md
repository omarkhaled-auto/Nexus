---
phase: 07-kanban-ui
plan: 02
type: execute
depends_on: ["07-01"]
files_modified: [package.json, src/renderer/src/components/kanban/KanbanBoard.tsx, src/renderer/src/components/kanban/KanbanColumn.tsx, src/renderer/src/components/kanban/FeatureCard.tsx, src/renderer/src/components/kanban/index.ts, src/renderer/src/pages/KanbanPage.tsx]
---

<objective>
Create core Kanban board infrastructure with @dnd-kit drag-and-drop.

Purpose: Build the 6-column Kanban board with draggable feature cards.
Output: Working drag-and-drop board with proper visual feedback.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-kanban-ui/07-CONTEXT.md
@.planning/phases/07-kanban-ui/07-RESEARCH.md
@.planning/phases/07-kanban-ui/07-01-SUMMARY.md
@src/renderer/src/stores/featureStore.ts
@src/renderer/src/types/feature.ts

**From 07-RESEARCH.md - Standard Stack:**
```bash
pnpm add @dnd-kit/core @dnd-kit/sortable @dnd-kit/utilities
```

**From 07-RESEARCH.md - Key Patterns:**
- DndContext with PointerSensor + KeyboardSensor
- SortableContext with verticalListSortingStrategy
- useDroppable for columns, useSortable for cards
- DragOverlay for smooth visual feedback
- closestCenter collision detection

**From 07-CONTEXT.md - 6 Columns:**
1. backlog - "Backlog"
2. planning - "Planning"
3. in_progress - "In Progress" (WIP: 3)
4. ai_review - "AI Review"
5. human_review - "Human Review"
6. done - "Done"

**Established patterns:**
- Cursor-style aesthetic (dark gradients, accent colors)
- cn() utility for class merging
- shadcn/ui components available
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install @dnd-kit packages</name>
  <files>package.json</files>
  <action>
    Install the @dnd-kit core packages:
    ```bash
    pnpm add @dnd-kit/core @dnd-kit/sortable @dnd-kit/utilities
    ```

    This provides:
    - @dnd-kit/core: DndContext, sensors, collision detection
    - @dnd-kit/sortable: SortableContext, useSortable, arrayMove
    - @dnd-kit/utilities: CSS transform helpers
  </action>
  <verify>Check package.json includes all three @dnd-kit packages</verify>
  <done>@dnd-kit/core, @dnd-kit/sortable, @dnd-kit/utilities in dependencies</done>
</task>

<task type="auto">
  <name>Task 2: Create KanbanBoard with DndContext</name>
  <files>src/renderer/src/components/kanban/KanbanBoard.tsx, src/renderer/src/components/kanban/index.ts</files>
  <action>
    Create KanbanBoard.tsx:

    1. Define COLUMNS constant with 6 columns (id, title, limit):
       - backlog: "Backlog", no limit
       - planning: "Planning", no limit
       - in_progress: "In Progress", limit 3
       - ai_review: "AI Review", no limit
       - human_review: "Human Review", no limit
       - done: "Done", no limit

    2. Set up DndContext with:
       - sensors: PointerSensor (distance: 5) + KeyboardSensor (sortableKeyboardCoordinates)
       - collisionDetection: closestCenter
       - onDragStart: set activeId state
       - onDragEnd: handle moveFeature or reorderFeatures via store
       - onDragCancel: clear activeId

    3. Render 6 KanbanColumn components in horizontal flex layout

    4. Add DragOverlay with FeatureCard clone when activeId is set

    5. Use useFeatures() and useFeaturesByStatus() selectors from store

    Style: Dark theme, horizontal scroll on overflow, gap-4 between columns.

    Create barrel export in index.ts.
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - KanbanBoard exports from barrel file
    - Component structure matches @dnd-kit patterns from research
  </verify>
  <done>KanbanBoard renders 6 columns with DndContext wrapping</done>
</task>

<task type="auto">
  <name>Task 3: Create KanbanColumn and FeatureCard</name>
  <files>src/renderer/src/components/kanban/KanbanColumn.tsx, src/renderer/src/components/kanban/FeatureCard.tsx, src/renderer/src/components/kanban/index.ts</files>
  <action>
    Create KanbanColumn.tsx:

    1. Props: column (id, title, limit), features (Feature[])

    2. Use useDroppable({ id: column.id, data: { columnId: column.id } })

    3. Wrap features in SortableContext with verticalListSortingStrategy

    4. Render column header with:
       - Title
       - Count badge showing features.length (and /limit if limit exists)
       - Highlight ring when isOver is true

    5. Render FeatureCard for each feature

    Style: min-w-[280px] flex-1, bg-muted/30, rounded-lg, p-3, space-y-2 for cards

    ---

    Create FeatureCard.tsx:

    1. Props: feature (Feature), isOverlay? (boolean for DragOverlay clone)

    2. Use useSortable({ id: feature.id })

    3. Apply transform/transition via CSS.Transform.toString()

    4. Render card with:
       - Title (font-medium)
       - Description snippet (text-sm text-muted-foreground, line-clamp-2)
       - Priority indicator (colored left border)
       - Basic complexity text (will enhance in 07-03)

    5. When isDragging (not overlay), apply opacity-50

    Style: bg-card, border, rounded-lg, p-3, cursor-grab

    Priority border colors:
    - critical: border-l-red-500
    - high: border-l-orange-500
    - medium: border-l-yellow-500
    - low: border-l-gray-500

    Export both from index.ts.
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - KanbanColumn and FeatureCard export from barrel
    - useSortable and useDroppable hooks used correctly
  </verify>
  <done>Columns are droppable, cards are sortable, drag works between columns</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm run typecheck` passes
- [ ] All 3 @dnd-kit packages installed
- [ ] KanbanBoard, KanbanColumn, FeatureCard created
- [ ] Drag-and-drop works between columns (manual test or type check)
- [ ] DragOverlay provides visual feedback
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- 6-column Kanban board renders with feature cards
- Drag-and-drop updates store via featureStore actions
</success_criteria>

<output>
After completion, create `.planning/phases/07-kanban-ui/07-02-SUMMARY.md`:

# Phase 07-02: Kanban Board Core Summary

**[One-liner about what shipped]**

## Accomplishments

- Installed @dnd-kit (core, sortable, utilities)
- Created KanbanBoard with DndContext and 6 columns
- Created KanbanColumn with useDroppable
- Created FeatureCard with useSortable

## Files Created

| File | Purpose |
|------|---------|
| src/renderer/src/components/kanban/KanbanBoard.tsx | Main board with DndContext |
| src/renderer/src/components/kanban/KanbanColumn.tsx | Droppable column container |
| src/renderer/src/components/kanban/FeatureCard.tsx | Sortable feature card |
| src/renderer/src/components/kanban/index.ts | Barrel export |

## Decisions Made

| Decision | Rationale |
|----------|-----------|
| ... | ... |

## Next Step

Ready for 07-03-PLAN.md (Feature Card Enhancements + Header)
</output>
