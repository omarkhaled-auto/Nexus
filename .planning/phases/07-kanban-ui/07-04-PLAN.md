---
phase: 07-kanban-ui
plan: 04
type: execute
depends_on: ["07-03"]
files_modified: [src/renderer/src/components/kanban/FeatureDetailModal.tsx, src/renderer/src/components/kanban/TaskList.tsx, src/renderer/src/components/kanban/FeatureCard.tsx, src/renderer/src/components/kanban/index.ts]
---

<objective>
Create feature detail modal with task list and agent activity view.

Purpose: Enable expanded view of features with full task breakdown and activity timeline.
Output: Click-to-expand modal with task list and agent activity.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-kanban-ui/07-CONTEXT.md
@.planning/phases/07-kanban-ui/07-03-SUMMARY.md
@src/renderer/src/components/kanban/FeatureCard.tsx
@src/renderer/src/types/feature.ts
@src/renderer/src/stores/taskStore.ts

**From 07-CONTEXT.md - Specific Ideas:**
- FeatureDetailModal: Click to expand card into modal with task list, agent activity, timeline

**Established patterns:**
- shadcn Dialog component for modals
- shadcn ScrollArea for scrollable content
- Lucide icons for visual indicators
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TaskList component</name>
  <files>src/renderer/src/components/kanban/TaskList.tsx, src/renderer/src/components/kanban/index.ts</files>
  <action>
    Create TaskList.tsx:

    1. Props: tasks (Task[] from taskStore type), featureId (string)

    2. Render list of tasks with:
       - Task name
       - Status indicator (pending, in_progress, completed, failed)
       - Assigned agent (if any)
       - Estimated time (if available)

    3. Status colors:
       - pending: gray circle
       - in_progress: amber circle with pulse
       - completed: green checkmark
       - failed: red X

    4. If no tasks, show "No tasks yet" placeholder

    5. Style: Space-y-2, each task is a flex row with status, name, agent

    Layout for each task:
    ```
    [●] Task name                    [Agent] [15m]
    ```

    Export from index.ts.
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - TaskList renders task items with status indicators
  </verify>
  <done>TaskList shows all tasks with status, agent, and time</done>
</task>

<task type="auto">
  <name>Task 2: Create FeatureDetailModal</name>
  <files>src/renderer/src/components/kanban/FeatureDetailModal.tsx, src/renderer/src/components/kanban/index.ts</files>
  <action>
    Create FeatureDetailModal.tsx:

    1. Props: feature (Feature | null), open (boolean), onOpenChange (callback)

    2. Use shadcn Dialog with DialogContent, DialogHeader, DialogTitle, DialogDescription

    3. Modal layout:
       ```
       ┌─────────────────────────────────────────┐
       │ [X]                                      │
       │ Feature Title                 [S/M/XL]  │
       │ Full description text here...           │
       │ ─────────────────────────────────────── │
       │ Status: In Progress    Priority: High   │
       │ Progress: ████████░░░░░░ 60%           │
       │ Agent: Coder - Running tests            │
       │ ─────────────────────────────────────── │
       │ Tasks (5)                               │
       │ [●] Implement API endpoint    [15m]     │
       │ [✓] Create database schema    [10m]     │
       │ [○] Write unit tests          [20m]     │
       │ ─────────────────────────────────────── │
       │ Activity Timeline                       │
       │ 12:45 - Agent started working           │
       │ 12:50 - Build passed                    │
       │ 12:52 - Tests running                   │
       └─────────────────────────────────────────┘
       ```

    4. Include:
       - Full description (not truncated)
       - ComplexityBadge
       - Current status with badge
       - Priority with colored indicator
       - ProgressIndicator (larger version)
       - AgentStatusIndicator
       - TaskList component
       - Activity timeline (placeholder - just show last few status changes)

    5. Use shadcn ScrollArea for content if too tall

    6. Style: Max-w-2xl, dark theme consistent with app

    Export from index.ts.
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - Modal opens with feature details
    - All sections render correctly
  </verify>
  <done>FeatureDetailModal shows expanded feature with tasks and activity</done>
</task>

<task type="auto">
  <name>Task 3: Wire modal to FeatureCard and add click handler</name>
  <files>src/renderer/src/components/kanban/FeatureCard.tsx, src/renderer/src/components/kanban/KanbanBoard.tsx</files>
  <action>
    Update FeatureCard.tsx:

    1. Add onClick prop that triggers when card is clicked (not dragged)

    2. Distinguish click from drag:
       - Use the isDragging state from useSortable
       - Only trigger onClick if !isDragging at click end
       - Or use a simple approach: onClick fires, parent decides what to do

    3. Make card visually clickable: cursor-pointer, hover:border-primary/50

    ---

    Update KanbanBoard.tsx:

    1. Add state: selectedFeature (Feature | null)

    2. Add FeatureDetailModal at end of component:
       ```tsx
       <FeatureDetailModal
         feature={selectedFeature}
         open={!!selectedFeature}
         onOpenChange={(open) => !open && setSelectedFeature(null)}
       />
       ```

    3. Pass onClick to FeatureCard:
       ```tsx
       <FeatureCard
         feature={feature}
         onClick={() => setSelectedFeature(feature)}
       />
       ```

    4. Handle click vs drag properly - only open modal on click, not on drag end
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - Clicking card opens modal
    - Dragging card does NOT open modal
    - Modal closes when clicking X or outside
  </verify>
  <done>Cards are clickable, modal opens with feature details, drag still works</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Kanban UI with drag-drop, feature cards, and detail modal</what-built>
  <how-to-verify>
    1. Run: `pnpm run dev:electron`
    2. Navigate to Evolution mode (click Evolution card on landing page)
    3. Verify: 6 columns visible (Backlog, Planning, In Progress, AI Review, Human Review, Done)
    4. Verify: Sample features visible with complexity badges and progress
    5. Test: Drag a feature card from one column to another
    6. Verify: Card moves to new column, no visual glitches
    7. Test: Click on a feature card
    8. Verify: Modal opens with feature details, task list, activity
    9. Test: Close modal by clicking X or outside
    10. Verify: No console errors throughout
  </how-to-verify>
  <resume-signal>Type "approved" to complete phase, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm run typecheck` passes
- [ ] TaskList and FeatureDetailModal created
- [ ] Cards are clickable (open modal) and draggable (move between columns)
- [ ] Modal shows all feature details with tasks
- [ ] Human verification checkpoint passed
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Click vs drag behavior works correctly
- Modal displays full feature details
- Phase 7 complete
</success_criteria>

<output>
After completion, create `.planning/phases/07-kanban-ui/07-04-SUMMARY.md`:

# Phase 07-04: Feature Detail Modal Summary

**[One-liner about what shipped]**

## Accomplishments

- Created TaskList component with status indicators
- Created FeatureDetailModal with full feature view
- Wired click handler to open modal
- Click vs drag behavior works correctly

## Files Created

| File | Purpose |
|------|---------|
| src/renderer/src/components/kanban/TaskList.tsx | Task list with status |
| src/renderer/src/components/kanban/FeatureDetailModal.tsx | Expanded feature view |

## Files Modified

| File | Changes |
|------|---------|
| src/renderer/src/components/kanban/FeatureCard.tsx | Added onClick handler |
| src/renderer/src/components/kanban/KanbanBoard.tsx | Added modal state and render |

## Phase 7 Completion

All 4 plans executed:
1. **07-01**: Feature Store (TDD) - X tests
2. **07-02**: Kanban Board Core - @dnd-kit integration
3. **07-03**: Feature Card Enhancements - Visual indicators
4. **07-04**: Feature Detail Modal - Click-to-expand (this plan)

**Kanban UI is now ready for backend integration.**

## Next Steps

Phase 8: Dashboard UI (BUILD-016)
- Progress metrics and charts
- Agent status grid
- Event log with filtering
</output>
