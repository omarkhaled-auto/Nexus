---
phase: 08-dashboard-ui
plan: 03
type: execute
depends_on: ["08-01"]
files_modified:
  - src/renderer/src/components/dashboard/AgentCard.tsx
  - src/renderer/src/components/dashboard/AgentActivity.tsx
  - src/renderer/src/components/dashboard/EventRow.tsx
  - src/renderer/src/components/dashboard/TaskTimeline.tsx
  - src/renderer/src/components/dashboard/index.ts
---

<objective>
Create agent activity grid and event timeline components for real-time monitoring.

Purpose: Build the "busy but organized" core - agent status grid showing all 4 agents at a glance, plus a filterable event log with auto-scroll for live activity tracking.
Output: AgentActivity grid with status indicators, TaskTimeline with React Virtuoso and filter chips.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-dashboard-ui/08-CONTEXT.md
@.planning/phases/08-dashboard-ui/08-RESEARCH.md

**Prior plan context:**
@.planning/phases/08-dashboard-ui/08-01-SUMMARY.md

**Existing patterns:**
@src/renderer/src/components/kanban/AgentStatusIndicator.tsx
@src/renderer/src/components/kanban/ProgressIndicator.tsx

**Store selectors available (from 08-01):**
- useAgentMetrics, useTimeline
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AgentCard and AgentActivity grid</name>
  <files>src/renderer/src/components/dashboard/AgentCard.tsx, src/renderer/src/components/dashboard/AgentActivity.tsx</files>
  <action>
    **AgentCard component:**
    Props matching AgentMetrics type:
    - id: string
    - name: string (e.g., "Coder-1", "Tester", "Reviewer")
    - status: 'idle' | 'working' | 'waiting' | 'error'
    - currentTask?: string (task name being worked on)
    - progress?: number (0-100)

    Visual design (from CONTEXT.md):
    ```
    â”‚  ðŸŸ¢ Coder-1    â”‚
    â”‚  auth.ts       â”‚
    â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 80% â”‚
    ```

    Status indicator colors:
    - idle: gray-500 (âšª)
    - working: green-500 (ðŸŸ¢) with pulse animation
    - waiting: yellow-500 (ðŸŸ¡)
    - error: red-500 (ðŸ”´)

    Card styling:
    - rounded-lg border border-border bg-card p-3
    - Status dot: w-2.5 h-2.5 rounded-full with appropriate color
    - Agent name: font-medium
    - Current task: text-sm text-muted-foreground truncate
    - Progress bar: reuse ProgressIndicator pattern or inline h-1.5 bg-muted rounded

    **AgentActivity component:**
    - 4-column grid (or 2x2 on mobile): grid-cols-2 lg:grid-cols-4 gap-3
    - Uses useAgentMetrics() selector from metricsStore
    - Renders AgentCard for each agent
    - Handles empty state (no agents yet)
    - Wrap in Card with header "Agent Activity"
  </action>
  <verify>AgentActivity renders 4 agent cards with proper status indicators, responsive grid layout</verify>
  <done>AgentCard displays status dot, name, task, progress. AgentActivity shows 4-agent grid from store.</done>
</task>

<task type="auto">
  <name>Task 2: Create TaskTimeline with Virtuoso and filters</name>
  <files>src/renderer/src/components/dashboard/EventRow.tsx, src/renderer/src/components/dashboard/TaskTimeline.tsx, src/renderer/src/components/dashboard/index.ts</files>
  <action>
    **EventRow component:**
    Props matching TimelineEvent type:
    - id: string
    - type: string (task_started, task_completed, task_failed, qa_iteration, build_started, build_completed, etc.)
    - title: string
    - timestamp: Date
    - metadata?: { agentId?: string, taskId?: string, iteration?: number }

    Visual design (from CONTEXT.md):
    ```
    â”‚  14:25  âœ“  Task api.routes.ts completed         Coder-2    â”‚
    ```

    Layout:
    - flex items-center gap-3 px-4 py-2 border-b border-border
    - Time: text-sm text-muted-foreground (format with date-fns format(timestamp, 'HH:mm'))
    - Icon: getEventIcon(type) - âœ“ CheckCircle2 green for success, X red for failed, RefreshCw for qa_iteration, etc.
    - Title: flex-1 text-sm
    - Agent: text-sm text-muted-foreground (from metadata.agentId)

    **TaskTimeline component:**
    Uses React Virtuoso for virtualized list with auto-scroll.

    State:
    - filter: FilterType ('all' | 'tasks' | 'qa' | 'builds' | 'errors')
    - autoScroll: boolean (true by default)

    Filter logic (useMemo):
    - all: return all events
    - tasks: type.startsWith('task_')
    - qa: type.startsWith('qa_')
    - builds: type.startsWith('build_')
    - errors: type.includes('failed') || type.includes('error')

    Filter chips UI:
    - Horizontal row of buttons: All, Tasks, QA, Builds, Errors
    - Active chip: bg-primary text-primary-foreground
    - Inactive: bg-muted hover:bg-muted/80
    - Rounded-full, text-sm, px-3 py-1

    Virtuoso configuration:
    - style={{ height: 400 }} or flex-1 for flexible height
    - data={filteredEvents}
    - followOutput={(isAtBottom) => autoScroll && isAtBottom ? 'smooth' : false}
    - itemContent renders EventRow

    Auto-scroll behavior:
    - onMouseEnter on container: setAutoScroll(false)
    - onMouseLeave: setAutoScroll(true)

    Wrap in Card with header "Recent Activity" and optional auto-scroll indicator.

    **Update barrel export:**
    Add AgentCard, AgentActivity, EventRow, TaskTimeline to index.ts
  </action>
  <verify>
    - TaskTimeline renders with Virtuoso
    - Filter chips toggle correctly
    - Auto-scroll pauses on hover
    - `pnpm typecheck` passes
  </verify>
  <done>TaskTimeline with Virtuoso virtualization, 5 filter chips, auto-scroll with pause-on-hover. EventRow displays formatted events.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm typecheck` - no TypeScript errors
- [ ] AgentActivity renders 4 agent cards
- [ ] TaskTimeline renders with filter chips
- [ ] Virtuoso scrolling works correctly
- [ ] Filter toggles work
- [ ] Auto-scroll pauses on hover
- [ ] All components exported from barrel file
</verification>

<success_criteria>
- AgentCard shows status dot, name, current task, progress bar
- AgentActivity renders 4-column responsive grid
- TaskTimeline uses React Virtuoso with followOutput
- 5 filter chips functional (All, Tasks, QA, Builds, Errors)
- Auto-scroll pauses on mouse enter, resumes on leave
- EventRow formats time, icon, title, agent
- All components use metricsStore selectors
</success_criteria>

<output>
After completion, create `.planning/phases/08-dashboard-ui/08-03-SUMMARY.md`:

# Phase 08-03: Activity Components Summary

**[Substantive one-liner]**

## Accomplishments

- [Key outcomes]

## Files Created/Modified

- [Files with descriptions]

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 08-04-PLAN.md (Integration)
</output>
