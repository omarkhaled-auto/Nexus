---
phase: 11-integration-testing
plan: 05
type: execute
depends_on: ["11-04"]
files_modified: [e2e/interview.spec.ts, e2e/kanban.spec.ts, e2e/execution.spec.ts, e2e/checkpoint.spec.ts]
---

<objective>
Create E2E tests for all major user flows using Playwright.

Purpose: Verify the complete user experience works from UI to backend and back.
Output: 16 E2E tests covering Interview, Kanban, Execution, and Checkpoint flows.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/11-integration-testing/11-CONTEXT.md
@.planning/phases/11-integration-testing/11-RESEARCH.md
@.planning/phases/11-integration-testing/11-04-SUMMARY.md

**E2E Test Spec (from CONTEXT.md):**
- Interview Flow (4): Load, send message, display requirements, complete
- Kanban Flow (4): Display board, drag feature, trigger planning, show activity
- Execution Flow (4): Start, progress updates, QA loop, complete/merge
- Checkpoint Flow (4): Create, list, restore, resume

**Page Objects available:**
- InterviewPage: sendMessage(), waitForResponse(), getRequirements()
- KanbanPage: getColumns(), dragFeature(), triggerPlanning()
- DashboardPage: getProgressBar(), getAgentCards(), getEventLog()
</context>

<tasks>

<task type="auto">
  <name>Task 1: Interview flow E2E tests</name>
  <files>e2e/interview.spec.ts</files>
  <action>
Create 4 E2E tests for the Interview flow:

```typescript
import { test, expect } from '../fixtures/electron'
import { InterviewPage } from '../page-objects/InterviewPage'

test.describe('Interview Flow', () => {
  test('E2E-INT-001: should load interview page', async ({ window }) => {
    const interview = new InterviewPage(window)
    await interview.navigate()
    await expect(window.locator('h1')).toContainText('Interview')
  })

  test('E2E-INT-002: should send message and receive response', async ({ window }) => {
    const interview = new InterviewPage(window)
    await interview.navigate()
    await interview.sendMessage('I want to build a task management app')
    await interview.waitForResponse()
    await expect(window.locator('[data-testid="assistant-message"]')).toBeVisible()
  })

  test('E2E-INT-003: should display extracted requirements', async ({ window }) => {
    // Send message that triggers requirement extraction
    // Verify requirements appear in sidebar
  })

  test('E2E-INT-004: should complete interview and proceed', async ({ window }) => {
    // Complete full interview flow
    // Click complete button
    // Verify navigation to next step
  })
})
```

Use Playwright's auto-wait for async operations. Avoid arbitrary sleeps.
  </action>
  <verify>npx playwright test e2e/interview.spec.ts (4 tests pass)</verify>
  <done>4 Interview E2E tests pass, covering load, chat, requirements, completion</done>
</task>

<task type="auto">
  <name>Task 2: Kanban and Execution flow E2E tests</name>
  <files>e2e/kanban.spec.ts, e2e/execution.spec.ts</files>
  <action>
**kanban.spec.ts** (4 tests):
```typescript
test.describe('Kanban Flow', () => {
  test('E2E-KB-001: should display kanban board', async ({ window }) => {
    // Seed features, navigate to kanban
    // Verify columns: Backlog, In Progress, Review, Done
  })

  test('E2E-KB-002: should drag feature between columns', async ({ window }) => {
    // Drag feature from Backlog to In Progress
    // Verify feature moved
  })

  test('E2E-KB-003: should trigger planning on complex feature', async ({ window }) => {
    // Click feature, trigger planning
    // Verify decomposition starts
  })

  test('E2E-KB-004: should show agent activity', async ({ window }) => {
    // Start execution, switch to dashboard
    // Verify agent cards appear
  })
})
```

**execution.spec.ts** (4 tests):
```typescript
test.describe('Execution Flow', () => {
  test('E2E-EX-001: should start execution', async ({ window }) => {
    // Trigger execution on a feature
    // Verify progress indicator appears
  })

  test('E2E-EX-002: should show progress updates', async ({ window }) => {
    // Watch for progress bar changes
    // Verify percentage increases
  })

  test('E2E-EX-003: should handle QA loop iterations', async ({ window }) => {
    // Trigger task that needs QA
    // Verify QA status displayed
  })

  test('E2E-EX-004: should complete and merge task', async ({ window }) => {
    // Run task to completion
    // Verify merged status
  })
})
```

For drag-drop in Kanban, use Playwright's drag API with proper coordinates.
  </action>
  <verify>npx playwright test e2e/kanban.spec.ts e2e/execution.spec.ts (8 tests pass)</verify>
  <done>8 tests pass covering Kanban board and execution flow</done>
</task>

<task type="auto">
  <name>Task 3: Checkpoint flow E2E tests</name>
  <files>e2e/checkpoint.spec.ts</files>
  <action>
Create 4 E2E tests for the Checkpoint flow:

```typescript
test.describe('Checkpoint Flow', () => {
  test('E2E-CP-001: should create checkpoint', async ({ window }) => {
    // Navigate to checkpoint UI
    // Trigger checkpoint creation (or let scheduler create one)
    // Verify checkpoint appears in list
  })

  test('E2E-CP-002: should list checkpoints', async ({ window }) => {
    // Seed multiple checkpoints
    // Verify list shows all with timestamps
  })

  test('E2E-CP-003: should restore checkpoint', async ({ window }) => {
    // Select older checkpoint
    // Click restore
    // Verify state rolled back
  })

  test('E2E-CP-004: should resume from checkpoint', async ({ window }) => {
    // Select checkpoint with pending tasks
    // Click resume
    // Verify execution continues
  })
})
```

Checkpoint tests may need to mock time or trigger checkpoints manually for reliability.
  </action>
  <verify>npx playwright test e2e/checkpoint.spec.ts (4 tests pass)</verify>
  <done>4 Checkpoint E2E tests pass, covering create, list, restore, resume</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx playwright test` passes all 16 E2E tests
- [ ] Tests run in < 5 minutes total
- [ ] No flaky tests (run 3 times in CI simulation)
- [ ] All major user flows verified
- [ ] HTML report generated
</verification>

<success_criteria>

- 16 E2E tests passing (4 Interview, 4 Kanban, 4 Execution, 4 Checkpoint)
- Tests use page objects for maintainability
- No arbitrary sleeps (use Playwright auto-wait)
- Phase 11 complete - all integration and E2E tests working
</success_criteria>

<output>
After completion, create `.planning/phases/11-integration-testing/11-05-SUMMARY.md`

**Final summary should include:**
- Total tests: 45 integration + 16 E2E = 61 new tests
- Coverage delta
- Any flaky test notes
- Phase 11 complete marker
</output>
